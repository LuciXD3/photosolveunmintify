function requestTokenFromBackground(e){chrome.runtime.sendMessage({message:"generate_token"},(t=>{"token_generated"===t.message&&e(t.payload)}))}document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("license_key_input"),t=document.getElementById("save_license_key"),s=document.getElementById("license_key_status");e&&t&&s&&(chrome.storage.sync.get(["deviceId","license_key","isPro"],(s=>{s.isPro?(e.value=s.license_key,t.disabled=!0):e.placeholder="8D248C59-3DCD4033-B41E8890-845FDBAD"})),t.addEventListener("click",(()=>{const a=e.value;t.disabled=!0,requestTokenFromBackground((e=>{fetch("https://coral-app-opv8j.ondigitalocean.app/verify_license",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({license_key:a})}).then((e=>e.json())).then((e=>{e.success?(chrome.storage.sync.set({deviceId:e.deviceId,license_key:a,isPro:!0}),s.textContent="License key valid!"):(s.textContent="Invalid license key!",t.disabled=!1)})).catch((e=>{console.error("Error verifying license key:",e),s.textContent="Invalid license key!",t.disabled=!1}))}))})));const a=document.getElementById("input_license_key"),n=document.getElementById("about_link"),c=document.getElementById("settings_link"),i=document.getElementById("license_key"),o=document.getElementById("about"),l=document.getElementById("settings"),d=document.getElementById("stealth_shortcut"),r=document.getElementById("save_settings"),v=document.getElementById("settings_status"),m=new URLSearchParams(window.location.search).get("tab");"settings"===m?(i.classList.remove("active"),o.classList.remove("active"),l.classList.add("active")):"license_key"===m?(o.classList.remove("active"),l.classList.remove("active"),i.classList.add("active")):(i.classList.remove("active"),l.classList.remove("active"),o.classList.add("active")),a&&n&&c&&i&&o&&l&&(a.addEventListener("click",(e=>{e.preventDefault(),o.classList.remove("active"),l.classList.remove("active"),i.classList.add("active")})),n.addEventListener("click",(e=>{e.preventDefault(),i.classList.remove("active"),l.classList.remove("active"),o.classList.add("active")})),c.addEventListener("click",(e=>{e.preventDefault(),i.classList.remove("active"),o.classList.remove("active"),l.classList.add("active")}))),chrome.storage.sync.get(["stealthShortcut"],(e=>{e.stealthShortcut?d.value=e.stealthShortcut:navigator.platform.toLowerCase().includes("win")?d.value="Ctrl+Shift+Q":navigator.platform.toLowerCase().includes("mac")&&(d.value="Command+Shift+Q")})),d.addEventListener("keydown",(e=>{e.preventDefault();const t=[];e.ctrlKey&&t.push("Ctrl"),e.shiftKey&&t.push("Shift"),e.altKey&&t.push("Alt"),e.metaKey&&t.push("Command");const s=`${t.join("+")}+${e.key.toUpperCase()}`;d.value=s})),r.addEventListener("click",(()=>{const e=d.value;chrome.storage.sync.set({stealthShortcut:e},(()=>{v.textContent="Settings saved!",chrome.runtime.sendMessage({message:"updateStealthShortcut",shortcut:e})}))}))}));